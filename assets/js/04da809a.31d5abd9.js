"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1968],{4137:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"deployment/kubernetes","title":"Kubernetes Deployment","description":"Deploy Site Availability Monitoring on Kubernetes for scalable, production environments.","source":"@site/docs/deployment/kubernetes.md","sourceDirName":"deployment","slug":"/deployment/kubernetes","permalink":"/site-availability/docs/deployment/kubernetes","draft":false,"unlisted":false,"editUrl":"https://github.com/Levy-Tal/site-availability/tree/main/docs/docs/deployment/kubernetes.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Docker Compose Deployment","permalink":"/site-availability/docs/deployment/docker-compose"},"next":{"title":"Helm Chart Deployment","permalink":"/site-availability/docs/deployment/helm"}}');var t=a(4848),l=a(8453);const s={sidebar_position:2},r="Kubernetes Deployment",o={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Helm Deployment (Recommended)",id:"helm-deployment-recommended",level:2},{value:"Quick Start",id:"quick-start",level:3},{value:"Custom Values",id:"custom-values",level:3},{value:"Manual Kubernetes Deployment",id:"manual-kubernetes-deployment",level:2},{value:"Namespace",id:"namespace",level:3},{value:"ConfigMap",id:"configmap",level:3},{value:"Backend Deployment",id:"backend-deployment",level:3},{value:"Service",id:"service",level:3},{value:"Ingress",id:"ingress",level:3},{value:"Monitoring and Observability",id:"monitoring-and-observability",level:2},{value:"ServiceMonitor (Prometheus Operator)",id:"servicemonitor-prometheus-operator",level:3},{value:"Grafana Dashboard",id:"grafana-dashboard",level:3},{value:"Scaling",id:"scaling",level:2},{value:"Horizontal Pod Autoscaler",id:"horizontal-pod-autoscaler",level:3},{value:"Security",id:"security",level:2},{value:"Network Policies",id:"network-policies",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"kubernetes-deployment",children:"Kubernetes Deployment"})}),"\n",(0,t.jsx)(n.p,{children:"Deploy Site Availability Monitoring on Kubernetes for scalable, production environments."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Kubernetes cluster (v1.20+)"}),"\n",(0,t.jsx)(n.li,{children:"kubectl configured"}),"\n",(0,t.jsx)(n.li,{children:"Helm 3.0+ (recommended)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"helm-deployment-recommended",children:"Helm Deployment (Recommended)"}),"\n",(0,t.jsx)(n.h3,{id:"quick-start",children:"Quick Start"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Add the repository (if available)\nhelm repo add site-availability https://levy-tal.github.io/site-availability\n\n# Or use local chart\ncd chart/\nhelm install site-availability . --namespace monitoring --create-namespace\n"})}),"\n",(0,t.jsx)(n.h3,{id:"custom-values",children:"Custom Values"}),"\n",(0,t.jsxs)(n.p,{children:["Create ",(0,t.jsx)(n.code,{children:"values.yaml"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"backend:\n  image:\n    repository: site-availability/backend\n    tag: latest\n  replicas: 3\n  resources:\n    requests:\n      cpu: 100m\n      memory: 128Mi\n    limits:\n      cpu: 500m\n      memory: 512Mi\n\nfrontend:\n  image:\n    repository: site-availability/frontend\n    tag: latest\n  replicas: 2\n\nprometheus:\n  enabled: true\n  server:\n    persistentVolume:\n      size: 10Gi\n\ningress:\n  enabled: true\n  hostname: monitoring.example.com\n  tls: true\n"})}),"\n",(0,t.jsx)(n.p,{children:"Deploy with custom values:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"helm install site-availability . -f values.yaml\n"})}),"\n",(0,t.jsx)(n.h2,{id:"manual-kubernetes-deployment",children:"Manual Kubernetes Deployment"}),"\n",(0,t.jsx)(n.h3,{id:"namespace",children:"Namespace"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Namespace\nmetadata:\n  name: site-availability\n"})}),"\n",(0,t.jsx)(n.h3,{id:"configmap",children:"ConfigMap"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: site-availability-config\n  namespace: site-availability\ndata:\n  config.yaml: |\n    scrape_interval: 30s\n    locations:\n      - name: Production\n        latitude: 40.712776\n        longitude: -74.005974\n    apps:\n      - name: api\n        location: Production\n        metric: up{instance="api:8080"}\n        prometheus: http://prometheus:9090/\n'})}),"\n",(0,t.jsx)(n.h3,{id:"backend-deployment",children:"Backend Deployment"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: site-availability-backend\n  namespace: site-availability\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: site-availability-backend\n  template:\n    metadata:\n      labels:\n        app: site-availability-backend\n    spec:\n      containers:\n        - name: backend\n          image: site-availability/backend:latest\n          ports:\n            - containerPort: 8080\n          env:\n            - name: CONFIG_FILE\n              value: /app/config.yaml\n          volumeMounts:\n            - name: config\n              mountPath: /app/config.yaml\n              subPath: config.yaml\n          resources:\n            requests:\n              cpu: 100m\n              memory: 128Mi\n            limits:\n              cpu: 500m\n              memory: 512Mi\n      volumes:\n        - name: config\n          configMap:\n            name: site-availability-config\n"})}),"\n",(0,t.jsx)(n.h3,{id:"service",children:"Service"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: site-availability-backend\n  namespace: site-availability\nspec:\n  selector:\n    app: site-availability-backend\n  ports:\n    - port: 8080\n      targetPort: 8080\n  type: ClusterIP\n"})}),"\n",(0,t.jsx)(n.h3,{id:"ingress",children:"Ingress"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: site-availability\n  namespace: site-availability\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\n    cert-manager.io/cluster-issuer: letsencrypt-prod\nspec:\n  tls:\n    - hosts:\n        - monitoring.example.com\n      secretName: site-availability-tls\n  rules:\n    - host: monitoring.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: site-availability-frontend\n                port:\n                  number: 80\n          - path: /api\n            pathType: Prefix\n            backend:\n              service:\n                name: site-availability-backend\n                port:\n                  number: 8080\n"})}),"\n",(0,t.jsx)(n.h2,{id:"monitoring-and-observability",children:"Monitoring and Observability"}),"\n",(0,t.jsx)(n.h3,{id:"servicemonitor-prometheus-operator",children:"ServiceMonitor (Prometheus Operator)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: site-availability\n  namespace: site-availability\nspec:\n  selector:\n    matchLabels:\n      app: site-availability-backend\n  endpoints:\n    - port: http\n      path: /metrics\n"})}),"\n",(0,t.jsx)(n.h3,{id:"grafana-dashboard",children:"Grafana Dashboard"}),"\n",(0,t.jsxs)(n.p,{children:["Import the provided dashboard from ",(0,t.jsx)(n.code,{children:"chart/grafana-dashboards/dashboard.json"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"scaling",children:"Scaling"}),"\n",(0,t.jsx)(n.h3,{id:"horizontal-pod-autoscaler",children:"Horizontal Pod Autoscaler"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: site-availability-backend-hpa\n  namespace: site-availability\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: site-availability-backend\n  minReplicas: 2\n  maxReplicas: 10\n  metrics:\n    - type: Resource\n      resource:\n        name: cpu\n        target:\n          type: Utilization\n          averageUtilization: 70\n"})}),"\n",(0,t.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,t.jsx)(n.h3,{id:"network-policies",children:"Network Policies"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: site-availability-netpol\n  namespace: site-availability\nspec:\n  podSelector:\n    matchLabels:\n      app: site-availability-backend\n  policyTypes:\n    - Ingress\n    - Egress\n  ingress:\n    - from:\n        - namespaceSelector:\n            matchLabels:\n              name: ingress-nginx\n      ports:\n        - protocol: TCP\n          port: 8080\n  egress:\n    - to:\n        - namespaceSelector:\n            matchLabels:\n              name: monitoring\n      ports:\n        - protocol: TCP\n          port: 9090\n"})}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check pod status\nkubectl get pods -n site-availability\n\n# View pod logs\nkubectl logs -f deployment/site-availability-backend -n site-availability\n\n# Describe pod for events\nkubectl describe pod <pod-name> -n site-availability\n\n# Check service endpoints\nkubectl get endpoints -n site-availability\n"})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>r});var i=a(6540);const t={},l=i.createContext(t);function s(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);