"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1478],{2955:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"configuration/prometheus","title":"Prometheus Configuration","description":"Configure Prometheus integration for metrics collection and monitoring.","source":"@site/docs/configuration/prometheus.md","sourceDirName":"configuration","slug":"/configuration/prometheus","permalink":"/site-availability/docs/configuration/prometheus","draft":false,"unlisted":false,"editUrl":"https://github.com/Levy-Tal/site-availability/tree/main/docs/docs/configuration/prometheus.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"HTTP Source Configuration","permalink":"/site-availability/docs/configuration/http-source"},"next":{"title":"Docker Compose Deployment","permalink":"/site-availability/docs/deployment/docker-compose"}}');var i=t(4848),s=t(8453);const a={sidebar_position:4},o="Prometheus Configuration",l={},c=[{value:"Basic Prometheus Setup",id:"basic-prometheus-setup",level:2},{value:"Metrics Configuration",id:"metrics-configuration",level:2},{value:"Custom Metrics",id:"custom-metrics",level:2},{value:"Recording Rules",id:"recording-rules",level:2},{value:"Alerting Rules",id:"alerting-rules",level:2},{value:"Federation",id:"federation",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"prometheus-configuration",children:"Prometheus Configuration"})}),"\n",(0,i.jsx)(n.p,{children:"Configure Prometheus integration for metrics collection and monitoring."}),"\n",(0,i.jsx)(n.h2,{id:"basic-prometheus-setup",children:"Basic Prometheus Setup"}),"\n",(0,i.jsxs)(n.p,{children:["Example ",(0,i.jsx)(n.code,{children:"prometheus.yml"})," configuration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'global:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n\nrule_files:\n  - "site_availability_rules.yml"\n\nscrape_configs:\n  - job_name: "site-availability"\n    static_configs:\n      - targets: ["site-availability:8080"]\n\n  - job_name: "monitored-apps"\n    static_configs:\n      - targets:\n          - "app1:8080"\n          - "app2:8080"\n          - "app3:9090"\n    scrape_interval: 30s\n    metrics_path: "/metrics"\n\nalerting:\n  alertmanagers:\n    - static_configs:\n        - targets:\n            - alertmanager:9093\n'})}),"\n",(0,i.jsx)(n.h2,{id:"metrics-configuration",children:"Metrics Configuration"}),"\n",(0,i.jsx)(n.p,{children:"Configure which metrics to scrape from your applications:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# config.yaml\napps:\n  - name: web-server\n    location: New York\n    metric: up{instance="web-server:8080", job="web"}\n    prometheus: http://prometheus:9090/\n\n  - name: api-server\n    location: London\n    metric: up{instance="api-server:8080", job="api"}\n    prometheus: http://prometheus:9090/\n\n  - name: database\n    location: Tokyo\n    metric: pg_up{instance="postgres:5432", job="postgres"}\n    prometheus: http://prometheus:9090/\n'})}),"\n",(0,i.jsx)(n.h2,{id:"custom-metrics",children:"Custom Metrics"}),"\n",(0,i.jsx)(n.p,{children:"Define custom metrics for your applications:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"custom_metrics:\n  - name: response_time\n    query: 'http_request_duration_seconds{job=\"web\"}'\n    threshold: 0.5\n\n  - name: error_rate\n    query: 'rate(http_requests_total{status=~\"5..\"}[5m])'\n    threshold: 0.05\n"})}),"\n",(0,i.jsx)(n.h2,{id:"recording-rules",children:"Recording Rules"}),"\n",(0,i.jsx)(n.p,{children:"Create recording rules for complex queries:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# site_availability_rules.yml\ngroups:\n  - name: site_availability\n    rules:\n      - record: site:availability:rate5m\n        expr: avg_over_time(up[5m])\n\n      - record: site:response_time:avg5m\n        expr: avg_over_time(http_request_duration_seconds[5m])\n"})}),"\n",(0,i.jsx)(n.h2,{id:"alerting-rules",children:"Alerting Rules"}),"\n",(0,i.jsx)(n.p,{children:"Define alerts for monitoring:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'groups:\n  - name: site_availability_alerts\n    rules:\n      - alert: SiteDown\n        expr: up == 0\n        for: 1m\n        labels:\n          severity: critical\n        annotations:\n          summary: "Site {{ $labels.instance }} is down"\n\n      - alert: HighErrorRate\n        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: "High error rate on {{ $labels.instance }}"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"federation",children:"Federation"}),"\n",(0,i.jsx)(n.p,{children:"For multi-prometheus setups:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# prometheus-federation.yml\nscrape_configs:\n  - job_name: "federate"\n    scrape_interval: 15s\n    honor_labels: true\n    metrics_path: "/federate"\n    params:\n      "match[]":\n        - \'{job=~"site-availability.*"}\'\n        - \'{__name__=~"up|site:.*"}\'\n    static_configs:\n      - targets:\n          - "prometheus-dc1:9090"\n          - "prometheus-dc2:9090"\n'})})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);