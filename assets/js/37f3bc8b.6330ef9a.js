"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1719],{1963:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"deployment/helm","title":"Helm Chart Deployment","description":"Deploy Site Availability Monitoring using the provided Helm chart for Kubernetes.","source":"@site/docs/deployment/helm.md","sourceDirName":"deployment","slug":"/deployment/helm","permalink":"/site-availability/docs/deployment/helm","draft":false,"unlisted":false,"editUrl":"https://github.com/Levy-Tal/site-availability/tree/main/docs/docs/deployment/helm.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Kubernetes Deployment","permalink":"/site-availability/docs/deployment/kubernetes"},"next":{"title":"Production Deployment","permalink":"/site-availability/docs/deployment/production"}}');var t=i(4848),l=i(8453);const s={sidebar_position:3},r="Helm Chart Deployment",o={},c=[{value:"Chart Overview",id:"chart-overview",level:2},{value:"Installation",id:"installation",level:2},{value:"Quick Install",id:"quick-install",level:3},{value:"Custom Installation",id:"custom-installation",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Backend Configuration",id:"backend-configuration",level:3},{value:"Frontend Configuration",id:"frontend-configuration",level:3},{value:"Ingress Configuration",id:"ingress-configuration",level:3},{value:"Upgrades",id:"upgrades",level:2},{value:"Upgrade Process",id:"upgrade-process",level:3},{value:"Version History",id:"version-history",level:3},{value:"Monitoring Integration",id:"monitoring-integration",level:2},{value:"Prometheus ServiceMonitor",id:"prometheus-servicemonitor",level:3},{value:"Grafana Dashboard",id:"grafana-dashboard",level:3},{value:"External Secrets",id:"external-secrets",level:2},{value:"Customization",id:"customization",level:2},{value:"Custom Values Templates",id:"custom-values-templates",level:3},{value:"Helm Hooks",id:"helm-hooks",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Chart Validation",id:"chart-validation",level:3},{value:"Common Issues",id:"common-issues",level:3},{value:"Uninstallation",id:"uninstallation",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"helm-chart-deployment",children:"Helm Chart Deployment"})}),"\n",(0,t.jsx)(n.p,{children:"Deploy Site Availability Monitoring using the provided Helm chart for Kubernetes."}),"\n",(0,t.jsx)(n.h2,{id:"chart-overview",children:"Chart Overview"}),"\n",(0,t.jsx)(n.p,{children:"The Helm chart includes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Backend deployment and service"}),"\n",(0,t.jsx)(n.li,{children:"Frontend deployment and service"}),"\n",(0,t.jsx)(n.li,{children:"ConfigMap for configuration"}),"\n",(0,t.jsx)(n.li,{children:"ServiceMonitor for Prometheus"}),"\n",(0,t.jsx)(n.li,{children:"Grafana dashboard ConfigMap"}),"\n",(0,t.jsx)(n.li,{children:"Ingress configuration"}),"\n",(0,t.jsx)(n.li,{children:"Optional external secrets"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.h3,{id:"quick-install",children:"Quick Install"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# From the repository root\nhelm install site-availability chart/ --namespace monitoring --create-namespace\n"})}),"\n",(0,t.jsx)(n.h3,{id:"custom-installation",children:"Custom Installation"}),"\n",(0,t.jsxs)(n.p,{children:["Create a ",(0,t.jsx)(n.code,{children:"values.yaml"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'# Image configuration\nbackend:\n  image:\n    repository: your-registry/site-availability-backend\n    tag: "v1.0.0"\n    pullPolicy: IfNotPresent\n\n  replicas: 3\n\n  resources:\n    requests:\n      cpu: 100m\n      memory: 128Mi\n    limits:\n      cpu: 500m\n      memory: 512Mi\n\nfrontend:\n  image:\n    repository: your-registry/site-availability-frontend\n    tag: "v1.0.0"\n\n  replicas: 2\n\n# Configuration\nconfig:\n  scrapeInterval: 30s\n  logLevel: info\n\n  locations:\n    - name: Production East\n      latitude: 40.712776\n      longitude: -74.005974\n    - name: Production West\n      latitude: 37.7749\n      longitude: -122.4194\n\n  apps:\n    - name: api-east\n      location: Production East\n      metric: up{instance="api-east:8080", job="api"}\n      prometheus: http://prometheus:9090/\n    - name: api-west\n      location: Production West\n      metric: up{instance="api-west:8080", job="api"}\n      prometheus: http://prometheus:9090/\n\n# Ingress configuration\ningress:\n  enabled: true\n  className: nginx\n  hostname: monitoring.example.com\n  tls:\n    enabled: true\n    secretName: site-availability-tls\n\n# Monitoring\nserviceMonitor:\n  enabled: true\n  namespace: monitoring\n\ngrafanaDashboard:\n  enabled: true\n  namespace: monitoring\n\n# External secrets (optional)\nexternalSecrets:\n  enabled: false\n  secretStore: vault-backend\n  secrets:\n    hmacSecret:\n      key: site-availability/hmac-secret\n      property: secret\n'})}),"\n",(0,t.jsx)(n.p,{children:"Install with custom values:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"helm install site-availability chart/ -f values.yaml --namespace monitoring\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,t.jsx)(n.h3,{id:"backend-configuration",children:"Backend Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"backend:\n  image:\n    repository: site-availability/backend\n    tag: latest\n    pullPolicy: IfNotPresent\n\n  replicas: 1\n\n  service:\n    type: ClusterIP\n    port: 8080\n\n  resources:\n    requests:\n      cpu: 100m\n      memory: 128Mi\n    limits:\n      cpu: 500m\n      memory: 512Mi\n\n  nodeSelector: {}\n  tolerations: []\n  affinity: {}\n\n  env:\n    - name: LOG_LEVEL\n      value: info\n"})}),"\n",(0,t.jsx)(n.h3,{id:"frontend-configuration",children:"Frontend Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"frontend:\n  image:\n    repository: site-availability/frontend\n    tag: latest\n\n  replicas: 1\n\n  service:\n    type: ClusterIP\n    port: 80\n\n  env:\n    - name: REACT_APP_API_URL\n      value: /api\n"})}),"\n",(0,t.jsx)(n.h3,{id:"ingress-configuration",children:"Ingress Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"ingress:\n  enabled: true\n  className: nginx\n  hostname: monitoring.example.com\n\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\n    cert-manager.io/cluster-issuer: letsencrypt-prod\n\n  tls:\n    enabled: true\n    secretName: site-availability-tls\n\n  paths:\n    frontend:\n      path: /\n      pathType: Prefix\n    backend:\n      path: /api\n      pathType: Prefix\n"})}),"\n",(0,t.jsx)(n.h2,{id:"upgrades",children:"Upgrades"}),"\n",(0,t.jsx)(n.h3,{id:"upgrade-process",children:"Upgrade Process"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Update chart values\nhelm upgrade site-availability chart/ -f values.yaml --namespace monitoring\n\n# Force recreation of pods\nhelm upgrade site-availability chart/ --force --namespace monitoring\n\n# Rollback if needed\nhelm rollback site-availability 1 --namespace monitoring\n"})}),"\n",(0,t.jsx)(n.h3,{id:"version-history",children:"Version History"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# View release history\nhelm history site-availability --namespace monitoring\n\n# Get release status\nhelm status site-availability --namespace monitoring\n"})}),"\n",(0,t.jsx)(n.h2,{id:"monitoring-integration",children:"Monitoring Integration"}),"\n",(0,t.jsx)(n.h3,{id:"prometheus-servicemonitor",children:"Prometheus ServiceMonitor"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"serviceMonitor:\n  enabled: true\n  namespace: monitoring\n  labels:\n    release: prometheus\n  interval: 30s\n  path: /metrics\n"})}),"\n",(0,t.jsx)(n.h3,{id:"grafana-dashboard",children:"Grafana Dashboard"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'grafanaDashboard:\n  enabled: true\n  namespace: monitoring\n  labels:\n    grafana_dashboard: "1"\n  annotations:\n    grafana_folder: "Site Availability"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"external-secrets",children:"External Secrets"}),"\n",(0,t.jsx)(n.p,{children:"Integration with external secret management:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"externalSecrets:\n  enabled: true\n  secretStore: vault-backend\n  refreshInterval: 1h\n\n  secrets:\n    hmacSecret:\n      name: site-availability-hmac\n      key: site-availability/hmac-secret\n      property: secret\n\n    tlsCert:\n      name: site-availability-tls\n      key: site-availability/tls\n      properties:\n        - cert\n        - key\n"})}),"\n",(0,t.jsx)(n.h2,{id:"customization",children:"Customization"}),"\n",(0,t.jsx)(n.h3,{id:"custom-values-templates",children:"Custom Values Templates"}),"\n",(0,t.jsx)(n.p,{children:"Create environment-specific values:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# values-development.yaml\nconfig:\n  logLevel: debug\nbackend:\n  replicas: 1\ningress:\n  hostname: monitoring-dev.example.com\n\n# values-production.yaml\nconfig:\n  logLevel: warn\nbackend:\n  replicas: 3\n  resources:\n    requests:\n      cpu: 200m\n      memory: 256Mi\n    limits:\n      cpu: 1000m\n      memory: 1Gi\n"})}),"\n",(0,t.jsx)(n.h3,{id:"helm-hooks",children:"Helm Hooks"}),"\n",(0,t.jsx)(n.p,{children:"The chart includes pre-install and pre-upgrade hooks for:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Database migrations"}),"\n",(0,t.jsx)(n.li,{children:"Configuration validation"}),"\n",(0,t.jsx)(n.li,{children:"Health checks"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h3,{id:"chart-validation",children:"Chart Validation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Lint the chart\nhelm lint chart/\n\n# Dry run installation\nhelm install site-availability chart/ --dry-run --debug\n\n# Template the chart\nhelm template site-availability chart/ -f values.yaml\n"})}),"\n",(0,t.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Image pull errors:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check image exists\ndocker pull site-availability/backend:latest\n\n# Verify image registry credentials\nkubectl get secrets -n monitoring\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Configuration errors:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check ConfigMap\nkubectl get configmap site-availability-config -o yaml\n\n# Validate YAML syntax\nhelm template chart/ | kubectl apply --dry-run=client -f -\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Service connectivity:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Test internal service\nkubectl run debug --image=busybox -it --rm -- /bin/sh\nwget -qO- http://site-availability-backend:8080/health\n"})}),"\n",(0,t.jsx)(n.h2,{id:"uninstallation",children:"Uninstallation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Uninstall release\nhelm uninstall site-availability --namespace monitoring\n\n# Clean up namespace (if desired)\nkubectl delete namespace monitoring\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>r});var a=i(6540);const t={},l=a.createContext(t);function s(e){const n=a.useContext(l);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);